module Collatz where

-- $setup
-- >>> :set -XUnicodeSyntax
--

-- |
-- >>> chain 3
-- [3,10,5,16,8,4,2,1]
--

-- |
-- >>> chain 23
-- [23,70,35,106,53,160,80,40,20,10,5,16,8,4,2,1]
--

-- |
-- >>> chain 196
-- [196,98,49,148,74,37,112,56,28,14,7,22,11,34,17,52,26,13,40,20,10,5,16,8,4,2,1]
--

-- |
-- >>> chain 400
-- [400,200,100,50,25,76,38,19,58,29,88,44,22,11,34,17,52,26,13,40,20,10,5,16,8,4,2,1]
--

chain âˆ· Integer â†’ [Integer]
chain 1 = [1]
chain n
    | even n =  n:chain (n `div` 2)
    | odd n  =  n:chain (n*3 + 1)
chain _ = undefined -- wut